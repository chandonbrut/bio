package rosalind.solutions.coursera

import rosalind.util.SplitLineMatrixReader
import javax.swing.{JComponent, JFileChooser}
import rosalind.algo.ScoredAlignmentGraph

/**
 * Created by Jonas on 24/12/13.
 */

/*
Sample Input:
     PLEASANTLY
     MEANLY

Sample Output:
     8
     PLEASANTLY
     -MEA--N-LY
 */
object W6L5_GLOBAL_ALIGNMENT extends JComponent with App with SplitLineMatrixReader {
  val file = new JFileChooser();
  file.showOpenDialog(this)

  val scores = read(file.getSelectedFile)

  val v = "HIFHLYYRLNEDTKMLKGMIHVPEFWQFGMACANYNWYPFNTVQQWGYFTHLPNWCMYLDIPLWTKDYTTPRHVYGIGSLFIVGKNWRTQTFSHIADHIFGNCTTQMRAFLACMVWWVSKNHKDTLGWNPGTGMWFLMRMCDADVAVECAYCVPHICNVSNCASKKRTRTEFYHMRIRAVKWGYMIISSACWNHVGCGNDVHAASIWWVACGQNHHRPQQKTINMRWEGMTWARWYRNRDKPTHWSCARLQEKRETKPRNEMWVTTYEWHTQMLGAWRIDCGVGNNCPWCQKMGMMRQDFCHHYCSFAHRKQPMGMVWFAVQCPSLPFMQIRSGLIEAYVEVNMFHLTYEAMTRGSVDNMEHKDMNFVQWPTNCNYAEKCWQYYNQFRAYANYRHMASTCVCGYHIHVYRRSEAGVDWEVEDEGLSSVCNMSRHAQPKYVQPWMDINELSWTDMHWIPLMPAFREYCVAASRFMWHKLQQFRQEGAPIRADTVKWSAVYMIKFATFKQATLTGWTPKGTWIYRPLFYYCYVPMIWVMSRQKHQCTELEIKRWEMAHYGVDIWNRKWKEQYNNSHNSDFCEGGIYRHFGQYLAECMLHAVFQDMRAVTSMLNLIAGLNDNHYKTIYPINGSWDREALAMKTKCCQRHAYIMAYCPFQDKFMYWDRYYPGDKLMVNYPSSNNTTYTEPDVLQMMRTVEAPIRTEYKGFAKVGEETEHCIVVDVVIHINIANFRELCSLTTTSEQQDHIGTVRCFQHRIAVHCAGKFWNAFCYHFDHQHMTRCAFQACEFSNPYKTLWVTVGWYRIPWCGSNQFTWYIRNVQYCQEFIVNHTTD"
  val w = "SIFHHPQQTTTYYRLLYGMIHVPEFWQDGMACNTVQQWNTGYFTHLYLDIPLWTKDGIGSLVVGKNHIADHIFGNCTTQVRGFLACMVWWVSKNHKDNLVWHEKWPGTQFWFLMRMCDADVANECMYCCTEEHICNVSNCASKKRTRTEFYHMRIRAYKWGYMIISSACVGCGNDVHAASIWQVACGQNHHTPFRQSDPQHKTRIPGCYRITNMREEGMTWARWYRHWSEKRETKTYEWHTGAWFWVTKAINYDWVKMFMNATQKMGKMRQDGCHHVLDHHCSFAHRKNPMGRVVWFAVQEPCTPFEGINQQIRPGLIEAYVEVNRKHLTYELMTPGSFDNMEHKDMNFVQWPTLNSWLFIPREKCWQYYNQFRAYANPGIAHRHMASTHVYSRSEVDYEVEDEGYSSVCSKDHTQVMSRHAQPKYQGLIELSWTDMHWYPAMPAFREYCASRFMWIWFKQQFRQEGAPIRAPTVKWGAVYMINEQDVQFATFKQALYELQLTGWTPKGTWIYRSLFYYCITHLKVPMIQQYFGAVMSRFHHQCTELEIKRWEGAHYGVDIWNNHHNSDFCQGGIYRHHGQYAECMLHAVFQLNLIAGLNDNHYKTIPPINGSWDREADAMKTKCKHAYIMAYCPFQDKTRYWDRYYPGQKLMRNYPSSNNTTYTEPDVSYKGFAKNGEETEHVDHVNFRELCTTTSEKQDHAGVVRCFQFRIAVHCAGKFWNMYCYHFQHQHGTVSVSECSTRNAFQACIFSNLYNHEFYYTVTVGWYRIPLCGSNQFTWYIRNVQYCQDFIVNHTTD"

//  val v = "MEANLY"
//  val w = "PENALTY"

  println(scores.mkString("\n"))

  val graph = new ScoredAlignmentGraph(v,w,scores,5)
  graph.printBacktrack()
  graph.output(v.size,w.size,List(),List())


}
