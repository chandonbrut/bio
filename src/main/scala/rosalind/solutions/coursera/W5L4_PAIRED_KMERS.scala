package rosalind.solutions.coursera

import rosalind.util.KMER
import rosalind.algo.{Node2, Graph}
import javax.swing.{JFileChooser, JComponent}

/**
 * Created by Jonas on 16/12/13.
 */

/*
Sample Input:
2
GAGA|TTGA
TCGT|GATG
CGTG|ATGT
TGGT|TGAG
GTGA|TGTT
GTGG|GTGA
TGAG|GTTG
GGTC|GAGA
GTCG|AGAT

Sample Output:
GTGGTCGTGAGATGTTGA
*/

/*
Input:
200

Output:
AACAGAAAGCGAGCGAACCGTCTCTTGCATTTCGCCCTATGTTACTATGCATTACCATGGCTTAAGTACGAAGAATCTGTGACGGAAGCTCTTCGCAGTTCGCTAGGGCCTGATAGATCAGGATGGTACATCTCCACCAATTATCCGCAGCAATTACACGCCCAACCTATTTCGGGGATCTAGCACGCCAAGGTGTCCACTCGGCGTTCGGGGAGACCACTACGACGATAGCATATCTCACCAGTTCGGCCCTTTCGTCACTGTCACTTCCTACTTCTAGCGGTCTGATGATATTATACCTGACCGACTTGAAACGGTATCTACGGGCCATGGGCACGTAATCATTCCATCTACCGTTACTCCTATCGCCTCATGATGCTGCCTGCAACCTATCGTTGGACACACCCGCATCTGGTTGGCGGTACTGGCAGATTATCGCGCTGGTTGTGTATTCTTAGCGGCAAATCACATCGGTTAATAAGTTTACGAACAGCACCAGCTCAACCGTTCATTGCCCCACCATACGAGACAGCGACAGGCACATCTGATCCGTGTATCGTCTCATGGCTAAATACATTTCACCGTTGCGTGGGGAAGTCCTTGTGCCATGCCTGTACAAAATGGCGGCCGTAAAGTTCCCATGCGAAGGAACATTCCGGCAGTCTGTTTTGCGTCTTAGGCCCTTGGTAATTACTACTTAGGGGAAGGTGGTCCTTACGGTATTCGTATAGATAAACCTCCTCCCGACTCTCGCTGATATAAACTGGGGCCGTGAGAAACTGGGTGTCAAGCATAGTTCTAGCTACATAGTTCCAAGCGTATTTCGGGGCTAGGCCGGGGGTGCGCCCTGGGCAACGCTCAGGGTGTCCCCCGTGACATGACGAGGGAGTAGCCTAGGCACATCGTTACTTATAACCCAAGCAACGCGCTGTTTAGGCGAATGACGTAGTACTCTATGCCGCTGCAGGTCCCTGGGCGTCAGGCCTGTGACGGAAGCTCTTCGCAGTTCGCTAGTAGGTGCGTCATCTCATGACACCCAACCCTTGTCTGTAAATGTGTGACGGAAGCTCTTCGCAGTTCGCTAGATCGAGTCCCCAGGACATCAGTATCTAACCTCCACTTCCTGTTCGCCTCCCCTTTGTTTTCATGCAGTTGTCATCTGCATGTCATGTATACAACCTATGGAGGAAGTCTCGATGTCGGTTTCGGGGATGTGTGATCCCGTTGCGGTGACAGCGATCTTGTCATCGCTCACATAACTCATTAACTATTGAATTGGCGCCCTGGTTTCGCCGGTACGCTCAAGCATGCGACCCTGGAGGCAGCAGTACGAATTTTGAGGAAACCCAAGTACCGGAATCTTAAGGGCAGATAAGCCGTTAAAGCGATTGCTTTGATTGGCCCGGTAATCGGCCTGTGTGCAGCGCTTGTACCCTAAAAACATTCAAAAGAGTATACCAGTCGGTCGTACCTCATACTGTATGGCCCAACGGGATCTCTACTTATTTAATCTGACGCACTCATAATGCGAACTGATCTGCAACCTCATTAAGGCTACCACCTGCGGACGATAGGCGAACAATAACACTAGGGGGGTTAGATTCCCCAGGTTATGCATATCACCACTAGTGCGTATTGACAGCTGCCCCAGCCTCTAGAACATTTGGAGTTTTAATTTCAAACACTCGCACTCCATTCTAGGGGGCGCATATCATAGCGTATTTCTTGACGACCCTGATTGGACACGCAGCCCTAGGTAGACCGTGGGTAATTTCCTAACATTAAATTAACATAGTTCCTAATACCGACACAACCTCTGACTGGTCGCATGGACCTAGTGAGACCCCAGCAATGCCGTCGCGGACACACATCAGTTTTATGACAGCGTAAGGGTGGTACTAACCTGTATCGCCCGACAGGCGCATGTGTGATTCTCTCCGTAGAGTATGAGACTCTCGGGTAACATTATTAACGACCTGACCTCTTTCCTGCGCTCACCTACAGACGTTCAAAAGGGACCTCGGATAAATCTACATGAGAAGGGTAGCCATAATAACTAGTTGCATTCGCGCATCCATCACTGATGCGCGGCCACAAAGTTAATTGCCGCTAACACCTCGGTGACTCTACTCAATGTAAAGAATACCAGCCTAATCGAGGTTTTGACATGGCGCTCATGACTTAAAGGCCATGAGTCACTCACGCACAATGACTACCTCCCTCGGATGTGCCCTATGGGAGCCAGTATGAGTGTGCTGAGAAGAGCTCTCTCCGTATCGTCTCCGTAGAGGGTGCTTAACCTCCTATACTTTGCTTGGATAGGTGGGTGACGGAAGCTCTTCGCAGTTCGCTAGCAAATCGAATTATACGACTATGGGGGTTTCCCCCCCGGGCAATTCGTTTTATTGGGTGACGGAAGCTCTTCGCAGTTCGCTAGTTTACTTTTTGATTAAGTTCCGGCTACTAAAAAATGGCCCCGTAAAGTAAATTCCTAATACTCGACGGTAAACCCCTGATTAGAGTCCAATCGGCTCTTCACAAATACAGACTGTCCGGTTGGAGTGTTGCGTCATTCATGAGGTGCTAAACGTAACAGAACCACACATTGAACTGTTTGGGAACGGTAGGCTTCCTCACTTCAGAACCTAGCCCAAATCAGGCCTTGATACCTAACGTTCATACCGGGCTGACTACGCAACATAAGAGAATCTCTCCTCCTTAACGAGGTTTTGTGATTGACACCTGACAGGCTGTCAGTTTCCCACACCCTGGCGTATTAAGATATTAGTTTGCTTACGAGCATTGCGGATGTCTCAGAAAACACAGTAGCCAGTAAAATGTGATATTGACCAGAAGATCGCAAACTTCGCCAAGGTAAAGCTAAACTGAAGACCGTCTGCATAGGACCTCAATCGTTTGACTTCCAAGAAAGAAGGGTATACTACGACTTTCAAGTATTGATGCAGCCTTGCCATATCGAGTCGTCAGAGGATAGCATCTCGGGTGACCGTAGCTAAGATGCAGGTACTAGATCTAACAAGTATCCGTCCCCGTCCGATCTAAATCAAGTTAAAGGGTAGACCCAGGTGCTTTGACCAGACTTATTATCCGGTGACGGAAGCTCTTCGCAGGTGACGGAAGCTCTTCGCAGTTCGCTAGTTCGCTAGACGGGTGGAAGGAATTTGTATAGCGACAGGTTGTCATATCGATACAACGTAGACGCCCGCTCAAGAGTACGGTGGGATCAGGCACCCTTACTGCTTTCTACCCTTGCCAGAGGACCTGTAAGAACGGGCGGTTGCAGGAGGATTATAATCCCGAAAGCAGACGTTAAGTCGGACAAGAAGCATATTTTATATATAAGCGAGCTGGGCATAGTAGCCCGTGGGGCAAAGTGTCGCACCGCTATAAGCGAGCCCGCGGAAGTATGCTAACCCTAGTGTAGCCCCATCCAAGTGACTGTAGCAAGGAGCCGTGCTAGTGTGACGGAAGCTCTTCGCAGTTCGCTAGAGCGATCGTCCGTATCCTCGATCAACGAATTTAGAGTACCCGGAAGCCAGGGCCCTATGGCGTAACGACACGAGTTGGTCTACCAGAAAGACCGAGTAATTTTGCGTTCTTTCATTCCGTTTAAGGCGAATGAAACCAGCAACGAATGTCGTGTGGGCATAGGCAAATCCAACTGGAGGATTTACGCGCATGACGCATTCGTTGAACGAGGCCAAGCTAACATCGAAGTACTATTCTCTGACAGACGCTACTAGTTACCGCCTTTCATACCCATTCATGTGGCTCGGTCTGGAAATTCACATCTCGTGAATTTCACGTATCAGGGCAATTCCCCGAGCAGTGCTCGAAGACTACCCCAAACACTTCTAAAAGGTTCTGAGAGCTATCCTCAGGGGCACCATCGTTTGAAATCCACCCAAGACCTGATTTGTATGGCGCCCAGGGGAGGCGGTCCCCCCAACGCTCCGATTTAGCATTTCTGGGTGTTAACCCCTTAAACGAGGTCCCAGTGTAATAGAAACAGGTACGTAGCTTCCCGACTGGAGAGTCACCCTTACTCTAATCTGGTGCAGTCGCATGGTCCATACAACAAACAACCTTAAGATTCCTAAGTGGACCCTCGCCTTACATAGTCGGATTCTGACAGGTGTGCAAACCCCTCGCTAGTAGTCGTGACGGAAGCTCTTCGCAGTTCGCTAGGTTGCATGCATGAGACATTGACGGGGACCCGCAACCAGGTAACCAAATAGTTCGACCCCTCCCAGTTAAATATCTGCAAGCCGGCCAAGTCGCGCGGGTCAGGCGACGATTCCTAGGAAGAGGAGCAGTGTTGGAGAGTCTTATGAAGCCTAGGCACAGTCCTGGATTCCGTACCCCCCTTGCGATTACATCCACCGTTAGACTGATGTACGCACCCTGGTTATAGGAAAGGATAAGGGCCAGATGTTCGGTAAGCAAGGTGTTCGAGGCACCCTCCCCTCCTGGAGCTCGGTAGGCAACAGCCTTCTTATCGGCAAAGCCATAAACAAAATAGGAGTGAGTGATTAGTGGGGCAAGCCGTGACGGAAGCTCTTCGCAGTTCGCTAG
AACAGAAAGCGAGCGAACCGTCTCTTGCATTTCGCCCTATGTTACTATGCATTACCATGGCTTAAGTACGAAGAATCTGTGACGGAAGCTCTTCGCAGTTCGCTAGGGCCTGATAGATCAGGATGGTACATCTCCACCAATTATCCGCAGCAATTACACGCCCAACCTATTTCGGGGATCTAGCACGCCAAGGTGTCCACTCGGCGTTCGGGGAGACCACTACGACGATAGCATATCTCACCAGTTCGGCCCTTTCGTCACTGTCACTTCCTACTTCTAGCGGTCTGATGATATTATACCTGACCGACTTGAAACGGTATCTACGGGCCATGGGCACGTAATCATTCCATCTACCGTTACTCCTATCGCCTCATGATGCTGCCTGCAACCTATCGTTGGACACACCCGCATCTGGTTGGCGGTACTGGCAGATTATCGCGCTGGTTGTGTATTCTTAGCGGCAAATCACATCGGTTAATAAGTTTACGAACAGCACCAGCTCAACCGTTCATTGCCCCACCATACGAGACAGCGACAGGCACATCTGATCCGTGTATCGTCTCATGGCTAAATACATTTCACCGTTGCGTGGGGAAGTCCTTGTGCCATGCCTGTACAAAATGGCGGCCGTAAAGTTCCCATGCGAAGGAACATTCCGGCAGTCTGTTTTGCGTCTTAGGCCCTTGGTAATTACTACTTAGGGGAAGGTGGTCCTTACGGTATTCGTATAGATAAACCTCCTCCCGACTCTCGCTGATATAAACTGGGGCCGTGAGAAACTGGGTGTCAAGCATAGTTCTAGCTACATAGTTCCAAGCGTATTTCGGGGCTAGGCCGGGGGTGCGCCCTGGGCAACGCTCAGGGTGTCCCCCGTGACATGACGAGGGAGTAGCCTAGGCACATCGTTACTTATAACCCAAGCAACGCGCTGTTTAGGCGAATGACGTAGTACTCTATGCCGCTGCAGGTCCCTGGGCGTCAGGCCTGTGACGGAAGCTCTTCGCAGTTCGCTAGTAGGTGCGTCATCTCATGACACCCAACCCTTGTCTGTAAATGTGTGACGGAAGCTCTTCGCAGTTCGCTAGATCGAGTCCCCAGGACATCAGTATCTAACCTCCACTTCCTGTTCGCCTCCCCTTTGTTTTCATGCAGTTGTCATCTGCATGTCATGTATACAACCTATGGAGGAAGTCTCGATGTCGGTTTCGGGGATGTGTGATCCCGTTGCGGTGACAGCGATCTTGTCATCGCTCACATAACTCATTAACTATTGAATTGGCGCCCTGGTTTCGCCGGTACGCTCAAGCATGCGACCCTGGAGGCAGCAGTACGAATTTTGAGGAAACCCAAGTACCGGAATCTTAAGGGCAGATAAGCCGTTAAAGCGATTGCTTTGATTGGCCCGGTAATCGGCCTGTGTGCAGCGCTTGTACCCTAAAAACATTCAAAAGAGTATACCAGTCGGTCGTACCTCATACTGTATGGCCCAACGGGATCTCTACTTATTTAATCTGACGCACTCATAATGCGAACTGATCTGCAACCTCATTAAGGCTACCACCTGCGGACGATAGGCGAACAATAACACTAGGGGGGTTAGATTCCCCAGGTTATGCATATCACCACTAGTGCGTATTGACAGCTGCCCCAGCCTCTAGAACATTTGGAGTTTTAATTTCAAACACTCGCACTCCATTCTAGGGGGCGCATATCATAGCGTATTTCTTGACGACCCTGATTGGACACGCAGCCCTAGGTAGACCGTGGGTAATTTCCTAACATTAAATTAACATAGTTCCTAATACCGACACAACCTCTGACTGGTCGCATGGACCTAGTGAGACCCCAGCAATGCCGTCGCGGACACACATCAGTTTTATGACAGCGTAAGGGTGGTACTAACCTGTATCGCCCGACAGGCGCATGTGTGATTCTCTCCGTAGAGTATGAGACTCTCGGGTAACATTATTAACGACCTGACCTCTTTCCTGCGCTCACCTACAGACGTTCAAAAGGGACCTCGGATAAATCTACATGAGAAGGGTAGCCATAATAACTAGTTGCATTCGCGCATCCATCACTGATGCGCGGCCACAAAGTTAATTGCCGCTAACACCTCGGTGACTCTACTCAATGTAAAGAATACCAGCCTAATCGAGGTTTTGACATGGCGCTCATGACTTAAAGGCCATGAGTCACTCACGCACAATGACTACCTCCCTCGGATGTGCCCTATGGGAGCCAGTATGAGTGTGCTGAGAAGAGCTCTCTCCGTATCGTCTCCGTAGAGGGTGCTTAACCTCCTATACTTTGCTTGGATAGGTGGGTGACGGAAGCTCTTCGCAGTTCGCTAGCAAATCGAATTATACGACTATGGGGGTTTCCCCCCCGGGCAATTCGTTTTATTGGGTGACGGAAGCTCTTCGCAGTTCGCTAGTTTACTTTTTGATTAAGTTCCGGCTACTAAAAAATGGCCCCGTAAAGTAAATTCCTAATACTCGACGGTAAACCCCTGATTAGAGTCCAATCGGCTCTTCACAAATACAGACTGTCCGGTTGGAGTGTTGCGTCATTCATGAGGTGCTAAACGTAACAGAACCACACATTGAACTGTTTGGGAACGGTAGGCTTCCTCACTTCAGAACCTAGCCCAAATCAGGCCTTGATACCTAACGTTCATACCGGGCTGACTACGCAACATAAGAGAATCTCTCCTCCTTAACGAGGTTTTGTGATTGACACCTGACAGGCTGTCAGTTTCCCACACCCTGGCGTATTAAGATATTAGTTTGCTTACGAGCATTGCGGATGTCTCAGAAAACACAGTAGCCAGTAAAATGTGATATTGACCAGAAGATCGCAAACTTCGCCAAGGTAAAGCTAAACTGAAGACCGTCTGCATAGGACCTCAATCGTTTGACTTCCAAGAAAGAAGGGTATACTACGACTTTCAAGTATTGATGCAGCCTTGCCATATCGAGTCGTCAGAGGATAGCATCTCGGGTGACCGTAGCTAAGATGCAGGTACTAGATCTAACAAGTATCCGTCCCCGTCCGATCTAAATCAAGTTAAAGGGTAGACCCAGGTGCTTTGACCAGACTTATTATCCGGTGACGGAAGCTCTTCGCAGGTGACGGAAGCTCTTCGCAGTTCGCTAGTTCGCTAGACGGGTGGAAGGAATTTGTATAGCGACAGGTTGTCATATCGATACAACGTAGACGCCCGCTCAAGAGTACGGTGGGATCAGGCACCCTTACTGCTTTCTACCCTTGCCAGAGGACCTGTAAGAACGGGCGGTTGCAGGAGGATTATAATCCCGAAAGCAGACGTTAAGTCGGACAAGAAGCATATTTTATATATAAGCGAGCTGGGCATAGTAGCCCGTGGGGCAAAGTGTCGCACCGCTATAAGCGAGCCCGCGGAAGTATGCTAACCCTAGTGTAGCCCCATCCAAGTGACTGTAGCAAGGAGCCGTGCTAGTGTGACGGAAGCTCTTCGCAGTTCGCTAGAGCGATCGTCCGTATCCTCGATCAACGAATTTAGAGTACCCGGAAGCCAGGGCCCTATGGCGTAACGACACGAGTTGGTCTACCAGAAAGACCGAGTAATTTTGCGTTCTTTCATTCCGTTTAAGGCGAATGAAACCAGCAACGAATGTCGTGTGGGCATAGGCAAATCCAACTGGAGGATTTACGCGCATGACGCATTCGTTGAACGAGGCCAAGCTAACATCGAAGTACTATTCTCTGACAGACGCTACTAGTTACCGCCTTTCATACCCATTCATGTGGCTCGGTCTGGAAATTCACATCTCGTGAATTTCACGTATCAGGGCAATTCCCCGAGCAGTGCTCGAAGACTACCCCAAACACTTCTAAAAGGTTCTGAGAGCTATCCTCAGGGGCACCATCGTTTGAAATCCACCCAAGACCTGATTTGTATGGCGCCCAGGGGAGGCGGTCCCCCCAACGCTCCGATTTAGCATTTCTGGGTGTTAACCCCTTAAACGAGGTCCCAGTGTAATAGAAACAGGTACGTAGCTTCCCGACTGGAGAGTCACCCTTACTCTAATCTGGTGCAGTCGCATGGTCCATACAACAAACAACCTTAAGATTCCTAAGTGGACCCTCGCCTTACATAGTCGGATTCTGACAGGTGTGCAAACCCCTCGCTAGTAGTCGTGACGGAAGCTCTTCGCAGTTCGCTAGGTTGCATGCATGAGACATTGACGGGGACCCGCAACCAGGTAACCAAATAGTTCGACCCCTCCCAGTTAAATATCTGCAAGCCGGCCAAGTCGCGCGGGTCAGGCGACGATTCCTAGGAAGAGGAGCAGTGTTGGAGAGTCTTATGAAGCCTAGGCACAGTCCTGGATTCCGTACCCCCCTTGCGATTACATCCACCGTTAGACTGATGTACGCACCCTGGTTATAGGAAAGGATAAGGGCCAGATGTTCGGTAAGCAAGGTGTTCGAGGCACCCTCCCCTCCTGGAGCTCGGTAGGCAACAGCCTTCTTATCGGCAAAGCCATAAACAAAATAGGAGTGAGTGATTAGTGGGGCAAGCCGTGACGGAAGCTCTTCGCAGTTCGCTAG
 */

object W5L4_PAIRED_KMERS extends JComponent with App {
  val file = new JFileChooser()
  file.showOpenDialog(this)
  val d = 300

  val input = io.Source.fromFile(file.getSelectedFile).getLines()

  val pairs : List[(KMER,KMER)] = { for (p<-input)
                                    yield (new KMER(p.split("\\|")(0)),new KMER(p.split("\\|")(1))) }.toList
  val k = pairs(0)._1.content.size

  val dbg = Graph.deBruijnAdj2(pairs.toList)
  val euler = dbg.eulerianCycle()

  val prefixString = new StringBuilder
  val suffixString = new StringBuilder
  val stringLength = euler.size * euler(0).label.size + d

  prefixString.setLength(stringLength)
  suffixString.setLength(stringLength)


  for (i<-List.range(0,euler.size)) {
    val p1 = euler(i).c._1.content
    val i1 = i
    val f1 = i1 + p1.size-1
    prefixString.replace(i1,f1+1,p1)

    val p2 = euler(i).c._2.content
    val i2 = f1 + d + 1
    val f2 = i2 + p2.size - 1


    suffixString.replace(i2,f2+1,p2)
  }

  val pre = prefixString.mkString.trim
  val suf = suffixString.mkString.trim
  println(pre.substring(0,d+k) + suf)

}
